<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>LeafletJS Acara 5</title>
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
		<style>
            html, body{
                margin: 0;
            }

			#map {
				width: 100%;
				height: 100vh;
			}
		</style>
	</head>
	<body>
		<div id="map"></div>

        <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

		<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
		<script>
			// Inisialisasi peta
			var map = L.map("map").setView([-8.3354989,122.9727173], 11);

			// Tile Layer Base Map
			var basemap = L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
				attribution:
					'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> donatur jgn ngatur',
			});

			// Menambahkan basemap ke dalam peta
			basemap.addTo(map);

            // Define layer groups
            let toponimi_new = L.layerGroup();

            
            // Load geojson file
            fetch('Output/toponimi_new.geojson')
    .then(response => response.json())
    .then(data => {
        L.geoJSON(data, {
            onEachFeature: function (feature, layer) {
                // Add tooltip
                layer.bindTooltip(feature.properties.toponimi_new);
                

                // Example popup too
                var popup_content = "Nama: " + feature.properties.nama + "<br>" +
                    "Koordinat: " + feature.geometry.coordinates[1] + ", " + feature.geometry.coordinates[0];
                layer.bindPopup(popup_content);
            },

            pointToLayer: function (feature, latlng) {
                return L.marker(latlng, {
                    icon: L.icon({
                        iconUrl: "icon/home_marker.png", // icon marker
                        iconSize: [40, 40], // ukuran icon
                        iconAnchor: [24, 48], // posisi icon terhadap titik (point)
                        popupAnchor: [0, -48], // posisi popup terhadap icon
                        tooltipAnchor: [-16, -30], // posisi tooltip terhadap icon
                    }),
                });
            }
        }).addTo(toponimi_new);
    });

            toponimi_new.addTo(map);

// GeoJSON Polyline Jalan
var jalan_new = L.geoJSON(null, {
    // Style
    style: function (feature) {
        return {
            color: "Green",
            opacity: 1,
            weight: 2,
        };
    },

    // onEachFeature
    onEachFeature: function (feature, layer) {
        // Popup content
        var popup_content = "Fungsi: " + feature.properties.fungsi + "<br>" +
            "Panjang (m): " + feature.properties.panjang_m;

        // Bind popup directly
        layer.bindPopup(popup_content);

        // Bind tooltip on hover
        layer.bindTooltip(feature.properties.fungsi, {
            direction: "auto",
            sticky: true,
        });
    },
});

// Load the GeoJSON file
$.getJSON("Output/jalan_new.geojson", function (Output) {
    jalan_new.addData(Output); // Add data to GeoJSON layer
    map.addLayer(jalan_new);   // Add to map
});

// GeoJSON Polygon Jumlah Penduduk
map.createPane('panejumlahpenduduk');
map.getPane("panejumlahpenduduk").style.zIndex = 301;
var batas_kec = L.geoJSON(null, {
    style: function (feature) {
        if (feature.properties.Penduduk <= 15000) {
            return {
                opacity: 1,
                color: 'black',
                weight: 1.0,
                fillOpacity: 0.7,
                fillColor: '#ffffb2'
            };
        }
        if (feature.properties.Penduduk > 15000 && feature.properties.Penduduk <= 30000) {
            return {
                opacity: 1,
                color: 'black',
                weight: 1.0,
                fillOpacity: 0.7,
                fillColor: '#fd8d3c'
            };
        }
        if (feature.properties.Penduduk > 30000) {
            return {
                opacity: 1,
                color: 'black',
                weight: 1.0,
                fillOpacity: 0.7,
                fillColor: '#bd0026'
            };
        }
    },

    onEachFeature: function (feature, layer) {
        // Popup content
        var popup_content = "Kecamatan: " + feature.properties.kecamatan + "<br>" +
            "Jumlah Penduduk: " + feature.properties.Penduduk;

        // Bind popup to the polygon
        layer.bindPopup(popup_content);

        // Tooltip (optional)
        layer.bindTooltip(feature.properties.kecamatan, {
            direction: "auto",
            sticky: true,
        });
    }
});

// Load the GeoJSON file
$.getJSON("Output/bataskec_new.geojson", function (Output) {
    batas_kec.addData(Output);  // Add data to the polygon layer
    map.addLayer(batas_kec);    // Add polygon layer to the map
});

		</script>
	</body>
</html>